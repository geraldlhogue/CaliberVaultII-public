CaliberVaultII — Red Failures on Current Build

main commit: c51c3917b95865ad51864d92f1da1280cead7ac8
vitest.out.txt sha256: a5464427220d3ca02f644058d726525246a78d6c3d149760348e9c119520caee
Harness sentinel (runtime): HARNESS:2025-11-11T20:45Z:fa35a7e7

first 3 lines:

 RUN  v2.1.9 /Users/ghogue/Desktop/CaliberVaultII

last 3 lines:
   Start at  13:42:45
   Duration  57.54s (transform 1.68s, setup 16.59s, collect 20.47s, tests 54.81s, environment 64.78s, prepare 5.43s)

Summary:
 Test Files  11 failed | 37 passed (48)
      Tests  27 failed | 163 passed (190)

Failing files:
src/components/__tests__/AddItemModal.enhanced.test.tsx
src/components/__tests__/AddItemModal.test.tsx
src/components/__tests__/InventoryOperations.test.tsx
src/components/__tests__/SmartInstallPrompt.test.tsx
src/hooks/__tests__/useSubscription.test.ts
src/lib/__tests__/barcodeCache.test.ts
src/lib/__tests__/errorHandler.test.ts
src/services/__tests__/storage.service.test.ts
src/test/integration/api.test.ts
src/test/integration/comprehensive-categories.test.ts
src/test/integration/data-migration.test.ts

Failing specs (with reasons):
 × src/test/integration/data-migration.test.ts > Data Migration Validation > should create ammunition item successfully
  reason: expected 'Test Item 1' to be 'Test Ammo' // Object.is equality

 × src/test/integration/data-migration.test.ts > Data Migration Validation > should create magazine item successfully
  reason: expected undefined to be 30 // Object.is equality

 × src/test/integration/comprehensive-categories.test.ts > Comprehensive Category Integration Tests > Firearms Service Integration > creates firearm with all fields
  reason: Cannot read properties of undefined (reading 'insert')

 × src/test/integration/comprehensive-categories.test.ts > Comprehensive Category Integration Tests > Ammunition Service Integration > creates ammunition with specifications
  reason: Cannot read properties of undefined (reading 'insert')

 × src/test/integration/api.test.ts > API Integration Tests > REST API Endpoints > fetches inventory items via API
  reason: expected [ …(2) ] to deeply equal [ { id: '1', name: 'Item 1' }, …(1) ]

 × src/test/integration/api.test.ts > API Integration Tests > REST API Endpoints > creates item via API
  reason: expected { success: true, …(2) } to deeply equal { name: 'New Item', …(1) }

 × src/test/integration/api.test.ts > API Integration Tests > REST API Endpoints > handles API errors gracefully
  reason: promise resolved "[ …(2) ]" instead of rejecting

 × src/test/integration/api.test.ts > API Integration Tests > Real-time Subscriptions > subscribes to inventory changes
  reason: expected "spy" to be called at least once

 × src/components/__tests__/InventoryOperations.test.tsx > InventoryOperations > renders inventory dashboard
  reason: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.

 × src/components/__tests__/InventoryOperations.test.tsx > InventoryOperations > handles inventory operations
  reason: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: undefined. You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.

 × src/services/__tests__/storage.service.test.ts > StorageService > uploadFile > uploads file successfully
  reason: Cannot read properties of undefined (reading 'getSession')

 × src/hooks/__tests__/useSubscription.test.ts > useSubscription > returns subscription data with tier pro 1028ms
  reason: expected true to be false // Object.is equality

 × src/components/__tests__/SmartInstallPrompt.test.tsx > SmartInstallPrompt > shows install button when prompt is available 1006ms
  reason: expected null to be truthy

 × src/hooks/__tests__/useSubscription.test.ts > useSubscription > has hasFeature function that returns true 1071ms
  reason: expected true to be false // Object.is equality

 × src/lib/__tests__/errorHandler.test.ts > ErrorHandler > handles errors gracefully
  reason: handleError is not a function

 × src/lib/__tests__/errorHandler.test.ts > ErrorHandler > logs errors
  reason: ErrorHandler is not a constructor

 × src/lib/__tests__/errorHandler.test.ts > ErrorHandler > categorizes errors
  reason: ErrorHandler is not a constructor

 × src/components/__tests__/AddItemModal.test.tsx > AddItemModal > should render when open
  reason: expected null to be truthy

 × src/components/__tests__/AddItemModal.enhanced.test.tsx > AddItemModal Enhanced > renders modal with all features
  reason: Cannot read properties of undefined (reading 'onAuthStateChange')

 × src/components/__tests__/AddItemModal.enhanced.test.tsx > AddItemModal Enhanced > handles form validation
  reason: Cannot read properties of undefined (reading 'onAuthStateChange')

 × src/components/__tests__/AddItemModal.enhanced.test.tsx > AddItemModal Enhanced > supports all categories
  reason: Cannot read properties of undefined (reading 'onAuthStateChange')

 × src/hooks/__tests__/useSubscription.test.ts > useSubscription > returns defined limits 1155ms
  reason: expected true to be false // Object.is equality

 × src/lib/__tests__/barcodeCache.test.ts > BarcodeCacheManager > initializes cache manager 10005ms
  reason: Hook timed out in 10000ms.

 × src/lib/__tests__/barcodeCache.test.ts > BarcodeCacheManager > caches barcode data 10002ms
  reason: Hook timed out in 10000ms.

 × src/lib/__tests__/barcodeCache.test.ts > BarcodeCacheManager > retrieves cached data 10002ms
  reason: Hook timed out in 10000ms.

 × src/lib/__tests__/barcodeCache.test.ts > BarcodeCacheManager > returns null for non-existent barcode 10001ms
  reason: Hook timed out in 10000ms.

 × src/lib/__tests__/barcodeCache.test.ts > BarcodeCacheManager > clears all cache 10001ms
  reason: Hook timed out in 10000ms.
